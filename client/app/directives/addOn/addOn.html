<div class="col s5">
     <ul class="card collection" ng-if="package.packageType == 'contractor'">
         <div class="card-header">
             <div class="row">
                 <div class="col s6">
                     <a class='dropdown-button btn-flat' style="margin-top: 15px" data-gutter="15"
                        data-activates='itemFilter' dropdown data-beloworigin="true" data-constrainwidth="false">
                       {{(allItemsText) ? allItemsText : 'All items'}}<i class="mdi-navigation-arrow-drop-down"></i>
                     </a>
                       <ul id='itemFilter' class='dropdown-content' style="margin-top: 15px">
                        <!-- <li>
                        <a ng-click="showAll(); hideAll = true; showAll = true; showVariation = false; showDocument = false; showDefect = false; showDocument = false; showInvoice = false;">All ITEMS
                        </a>
                         </li> -->
                         <li>
                          <a ng-click="showVariations(); hideAll = true; showVariation = true; showDocument = false; showDefect = false; showDocument = false; showInvoice = false;">VARIATIONS
                          </a>
                         </li>
                         <li><a ng-click="showDefects(); hideAll = true; showDefect = true; showDocument = false; showVariation = false; showInvoice = false;">DEFECTS</a></li>
                         <li><a ng-click="showInvoices(); hideAll = true; showInvoice = true; showDefect = false; showVariation = false; showDocument = false;">INVOICES</a></li>
                         <li><a ng-click="showDocument(); hideAll = true; showDocument = true; showVariation = false; showDefect = false; showInvoice = false;">DOCUMENTS</a></li>
                       </ul>
                 </div>
                 <div class="col s6">
                     <a class='dropdown-button btn-flat btn-flat right' style="margin-top: 15px;" data-gutter="-30" href='#'
                        data-activates='relatedActions' dropdown data-beloworigin="true" data-constrainwidth="false">
                         <i class="mdi-navigation-more-vert"></i>
                     </a>
                      <ul id='relatedActions' class='dropdown-content' style="margin-top: 15px">
                         <li><a class="modal-trigger" href="#modal_attachVariation">Attach Variation</a></li>
                         <li ng-if="currentTeam.type == 'buider'"><a class="modal-trigger" href="#modal_attachDefect">Attach Defect</a></li>
                         <li><a class="modal-trigger" href="#modal_attachDocument">Attach Document</a></li>
                         <li ng-if="currentTeam.type == 'contractor'"><a class="modal-trigger" href="#attachInvoice">Attach Invoice</a></li>
                      </ul>
                 </div>
             </div>
         </div>
         <div class="divider"></div>
           <div style="height: 300px;" ng-hide="hideAll" ng-show="showAll">
            
            <li class="collection-item" ng-repeat="item in package.variations" ng-if="package.variations">
              <a class="modal-trigger" href="#modal-contractor-package-variation-{{item._id}}">Variation - {{item.title}}</a>
            </li>
            <li class="collection-item" ng-repeat="item in package.defects" ng-if="package.defects">
              <a class="modal-trigger" href="#modal-contractor-package-defect-{{item._id}}">Defect - {{item.title}}</a>
            </li>
            <li class="collection-item" ng-repeat="item in package.invoices" ng-if="package.invoices">
              <a class="modal-trigger" href="#modal-contractor-package-invoice-{{item._id}}">Invoices - {{item.title}}</a>
            </li>
            <li class="collection-item" ng-repeat="file in documents" ng-if="documents">
              <a class="modal-trigger" href="#modal-contractor-package-file-{{file._id}}">Document - {{file.title}}</a></li>
           </div>
           <div style="height: 300px" ng-show="showVariation" ng-if="variations">
               <li class="collection-item" ng-repeat="variation in variations.variations">
                <a class="modal-trigger" href="#modal-contractor-package-variation-{{variation._id}}">{{variation.title}}</a></li>
           </div>
           <div style="height: 300px" ng-show="showDefect" ng-if="defects">
               <li class="collection-item" ng-repeat="defect in defects.defects">
                <a class="modal-trigger" href="#modal-contractor-package-defect-{{defect._id}}">{{defect.title}}</a></li>
           </div>
           <div style="height: 300px" ng-show="showInvoice" ng-if="invoices">
               <li class="collection-item" ng-repeat="invoice in invoices.invoices">
                <a class="modal-trigger" href="#modal-contractor-package-invoice-{{invoice._id}}">{{invoice.title}} - Total {{invoice.total}}</a></li>
           </div>
           <div style="height: 300px" ng-show="showDocument" ng-if="files">
              <li class="collection-item" ng-repeat="file in files">
                <a class="modal-trigger" href="#modal-contractor-package-file-{{item._id}}">{{file.title}}</a></li>
           </div>
     </ul>

     <ul class="card collection" ng-if="package.packageType == 'material'">
           <div class="card-header">
               <div class="row">
                   <div class="col s6">
                       <a class='dropdown-button btn-flat' style="margin-top: 15px" href='#' data-gutter="15"
                          data-activates='itemFilter' dropdown data-beloworigin="true" data-constrainwidth="false">
                         {{(allItemsText) ? allItemsText : 'All items'}}<i class="mdi-navigation-arrow-drop-down"></i>
                       </a>
                         <ul id='itemFilter' class='dropdown-content' style="margin-top: 15px">
                           <li><a ng-click="showDefects(); hideAll = true; showDefect = true; showDocument = false; showInvoice = false;">DEFECTS</a></li>
                           <li><a ng-click="showInvoices(); hideAll = true; showInvoice = true; showDefect = false; showDocument = false;">INVOICES</a></li>
                           <li><a ng-click="showDocument(); hideAll = true; showDocument = true; showDefect = false; showInvoice = false;">DOCUMENTS</a></li>
                         </ul>
                   </div>
                   <div class="col s6">
                       <a class='dropdown-button btn-flat btn-flat right' style="margin-top: 15px;" data-gutter="-30" href='#' data-activates='relatedActions' dropdown>
                           <i class="mdi-navigation-more-vert"></i>
                       </a>
                        <ul id='relatedActions' class='dropdown-content' style="margin-top: 15px">
                           <li ng-if="currentTeam.type == 'buider'"><a class="modal-trigger" href="#modal_attachDefect">Attach Defect</a></li>
                           <li ng-if="currentTeam.type == 'supplier'"><a class="modal-trigger" href="#attachInvoice">Attach Invoice</a></li>
                           <li><a class="modal-trigger" href="#modal_attachDocument">Attach Document</a></li>
                        </ul>
                   </div>
               </div>
           </div>
           <div class="divider"></div>
             <div style="height: 300px;" ng-hide="hideAll">
            <li class="collection-item" ng-repeat="item in package.defects" ng-if="package.defects">
              <a class="modal-trigger" href="#modal-material-package-defect-{{item._id}}">Defect - {{item.title}}</a>
            </li>
            <li class="collection-item" ng-repeat="item in package.invoices" ng-if="package.invoices">
              <a class="modal-trigger" href="#modal-material-package-invoice-{{item._id}}">Invoices - {{item.title}} - Total {{item.total}}</a>
            </li>
            <li class="collection-item" ng-repeat="file in documents" ng-if="documents">
              <a class="modal-trigger" href="#modal-material-package-file-{{file._id}}">Document - {{file.title}}</a></li>
             </div>
             <div style="height: 300px" ng-show="showDefect" ng-if="defects">
                 <li class="collection-item" ng-repeat="defect in defects.defects">
                  <a class="modal-trigger" href="#modal-material-package-defect-{{item._id}}">Defect - {{defect.title}}</a>
                </li>
             </div>
             <div style="height: 300px" ng-show="showInvoice" ng-if="invoices">
                 <li class="collection-item" ng-repeat="invoice in invoices.invoices">
                  <a class="modal-trigger" href="#modal-material-package-invoice-{{item._id}}">Invoices - {{invoice.title}} - Total {{invoice.total}}</a></li>
             </div>
             <div style="height: 300px" ng-show="showDocument" ng-if="files">
                <li class="collection-item" ng-repeat="file in files">
                  <a class="modal-trigger" href="#modal-material-package-file-{{file._id}}">Document - {{file.title}}</a>
                </li>
             </div>
       </ul>
 </div> 

<div id="modal_attachDefect" class="modal modal-fixed-footer">
  <form method="POST" ng-submit="sendDefect()" >
    <div class="modal-content">
      <div class="row">
        <div class="col s12">
          <h5>New Defect for Contractor Package {{package.name}}</h5>
        </div>
      </div>
      <div class="row valign-wrapper">
        <div class="input-field col s6">
          <input id="defect_title" type="text" class="validate valign" ng-model="defect.title">
          <label for="defect_title">Defect Title</label>
        </div>
        <div class="input-field col s6">
          <input id="defect_location" type="text" class="validate valign" ng-model="defect.location">
          <label for="defect_location">Location of the Defect</label>
        </div>
      </div>
      <div class="row">
        <div class="input-field col s12">
          <textarea id="defect_description" class="materialize-textarea" ng-model="defect.description"></textarea>
          <label for="defect_description">Description of Defect</label>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button href="#!" class="modal-action modal-close waves-effect waves-green btn-flat ">Send Defect!</button>
      <button type="button" href="#!" class="modal-action modal-close waves-effect waves-green btn-flat ">Cancel</button>
    </div>
  </form>
</div>

<div id="attachInvoice" class="modal modal-fixed-footer">
  <form method="POST" ng-submit="sendInvoice()">
    <div class="modal-content">
    
       <div class="row">
         <div class="col s12">
           <h5>New Invoice for Builder Package {{package.name}}</h5>
         </div>
       </div>
       <div class="row">
         <div class="input-field col s12">
                 <input id="project_name" type="text" class="validate" ng-model="invoice.title">
                 <label for="project_name">Invoice Title</label>
             </div>
       </div>
       <div class="row">
         <div class="col s12">
          <ul class="collection z-depth-1">
            <li class="collection-item vlalign-wrapper">
              <div class="row" style="margin-bottom: 0px">
                <div class="col s6 valign center-align background-hover">
                  <a ng-click="addLineWithRate()" class="waves-effect waves-light btn-flat">Add Line with Rate</a>
                </div>
                <div class="col s6 valign center-align background-hover">
                  <a ng-click="addLineWithPrice()" class="waves-effect waves-light btn-flat">Add Line with Price</a>
                </div>
              </div>
            </li>
            <li class="collection-item vlalign-wrapper">
              <div class="row form" style="margin-bottom: 0px" ng-repeat="lineWithRate in lineWithRates track by $index">
                <div class="input-field col s6">
                   <textarea value="This is a line item with Rate - note the field for qty is editable"id="description" class="materialize-textarea" ng-model="rate.lineWithRate.rateDescription[$index]" required></textarea>
                       <label for="description">Description of Item</label>
                    </div>
                <div class="input-field col s2" style="margin-top: 67px">
                        <input id="rate" type="text" class="validate" ng-model="rate.lineWithRate.rate[$index]" required>
                        <label for="rate">Rate</label>
                    </div>
                <div class="input-field col s1" style="margin-top: 67px">
                        <input id="quantity" type="text" class="validate" ng-model="rate.lineWithRate.rateQuantity[$index]" required>
                        <label for="quantity">Qty</label>
                    </div>
                <div class="input-field col s2" style="margin-top: 67px">
                        <input disabled id="quantity" type="text" class="validate" ng-model="rate.lineWithRate.rateTotal[$index]">
                        <label for="quantity">Line Total {{rate.lineWithRate.rate[$index] * rate.lineWithRate.rateQuantity[$index]}}</label>
                    </div>
                <div class="input-field col s1" style="margin-top: 67px">
                        <i class="small mdi-action-highlight-remove" ng-click="removeLineWithRate($index)"></i>
                    </div>
              </div>
            </li>
            <li class="collection-item vlalign-wrapper">
              <div class="row form" style="margin-bottom: 0px" ng-repeat="lineWithPrice in lineWithPrices track by $index">
                <div class="input-field col s6">
                   <textarea value="This is a line item with Price - the Qty field is set to 1 and only price can be changed."id="description" class="materialize-textarea" ng-model="price.lineWithPrice.description[$index]" required></textarea>
                       <label for="description">Description of Item</label>
                    </div>
                <div class="input-field col s2" style="margin-top: 67px">
                        <input id="rate" type="text" class="validate" ng-model="price.lineWithPrice.price[$index]" required>
                        <label for="rate">Price</label>
                    </div>
                <div class="input-field col s1" style="margin-top: 67px">
                        <input disabled value="1" id="quantity" type="text" class="validate" ng-model="price.lineWithPrice.quantity[$index]">
                        <label for="quantity">1</label>
                    </div>
                <div class="input-field col s2" style="margin-top: 67px">
                        <input disabled id="quantity" type="text" class="validate" ng-model="price.lineWithPrice.total[$index]">
                        <label for="quantity">Line Total {{price.lineWithPrice.price[$index]}}</label>
                    </div>
                <div class="input-field col s1" style="margin-top: 67px">
                        <i class="small mdi-action-highlight-remove" ng-click="removeLineWithPrice($index)"></i>
                    </div>
              </div>
            </li>
            </ul>
         </div>
       </div>
       <div class="row" style="margin-top: 50px">
         <div class="col s6 valign">
           <div class="file-field input-field">
               <!-- <input class="file-path validate" type="text"/> -->
               <div ng-show="uploader.queue.length" class="form-group">
                <div ng-repeat="item in uploader.queue">
                  <div class="row">
                    <div class="input-field col s8 offset-s2">
                      <input type="text" ng-model="item.file.name">
                      <label for="">File name</label>
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s8 offset-s2">
                    </div>
                  </div>
                </div>
              </div>
               <div class="btn tooltipped" data-position="top" data-delay="1" data-tooltip="Attach a File"><i class="mdi-editor-attach-file"></i>
                 <input type="file" nv-file-select="" uploader="uploader" />
               </div>
             </div>
         </div>
         <div class="input-field col s2 offset-s3" style="margin-top: -40px">
                <p>Sub-Total: {{subTotalRate + subTotalPrice}}</p>
            <p>GST: {{(subTotalRate + subTotalPrice) * 0.1}}</p>
            <p>Total: {{(subTotalRate + subTotalPrice) * 0.1 + (subTotalRate + subTotalPrice)}}</p>
             </div>
       </div>
       
     
    </div>
  <div class="divider"></div>
    <div class="modal-footer">
      <button type="submit" ng-click="uploadAll()" class="modal-action modal-close waves-effect waves-green btn-flat ">Send Invoice!</button>
     <!-- <a href="#!" ng-click="uploadAll();" >Send Invoice!</a> -->
     <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat ">Cancel</a>
    </div>
    </form>
</div>

<div id="modal_attachVariation" class="modal modal-fixed-footer">
  <form ng-submit="sendVariation()">
    <div class="modal-content">
      <div class="row">
        <div class="col s12">
          <h5>New Variation for Contractor Package {{contractorRequest.name}}</h5>
        </div>
      </div>
      <div class="row valign-wrapper">
        <div class="input-field col s8 offset-s2">
          <input id="project_name" type="text" class="validate valign" ng-model="variation.title">
          <label for="project_name">Variation Title</label>
        </div>

      </div>
      <div class="row">
        <div class="input-field col s8 offset-s2">
          <textarea id="variation_description" class="materialize-textarea" ng-model="variation.description"></textarea>
          <label for="variation_description">Description of Variation</label>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button type="submit" class="modal-action modal-close waves-effect waves-green btn-flat ">Send Variation!</button>
      <button type="button" class="modal-action modal-close waves-effect waves-green btn-flat ">Cancel</button>
    </div>
  </form>
</div>

<!-- modal for contractor variations -->
<div ng-repeat="variation in package.variations">
  <div class="modal modal-fixed-footer" id="modal-contractor-package-variation-{{variation._id}}">
    <div class="modal-content">
      <div class="col s12">
        <h6>{{variation.title}}</h6>
      </div>
      <div class="col s12">
        <p>{{variation.description}}</p>
      </div>
    </div>
    <div class="modal-footer">
      <a class="modal-action modal-close waves-effect waves-green btn-flat">Close</a>
    </div>
  </div>
</div>

<!-- modal for contractor defects -->
<div ng-repeat="defect in package.defects" class="modal modal-fixed-footer" id="modal-contractor-package-defect-{{defect._id}}">
  <div class="modal-content">
    <div class="col s12">
      <h5>Defect {{defect.title}}</h5>
    </div>
    <div class="col s12">
      <p>In {{defect.location}}, with description {{defect.description}}</p>
    </div>
  </div>
  <div class="modal-footer">
    <a class="modal-action modal-close waves-effect waves-green btn-flat">Close</a>
  </div>
</div>

<!-- modal for contractor invoice -->
<div ng-repeat="invoice in package.invoices" class="modal modal-fixed-footer" id="modal-contractor-package-invoice-{{invoice._id}}">
  <div class="modal-content">
    <div class="col s12">
      <h5>Invoice {{invoice.title}} with total {{invoice.total}}</h5>
    </div>
    <div class="col s12" ng-if="invoice.quotePrice">
      <h5>Quote price</h5>
      <table>
        <thead>
          <th>#</th>
          <th>Description</th>
          <th>Price</th>
          <th>Quantity</th>
          <th>Total</th>
        </thead>
        <tbody>
          <tr ng-repeat="price in invoice.quotePrice">
            <td>{{$index + 1}}</td>
            <td>{{price.description}}</td>
            <td>{{price.price}}</td>
            <td>1</td>
            <td>{{price.total}}</td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="col s12" ng-if="invoice.quoteRate">
      <h5>Quote rate</h5>
      <table>
        <thead>
          <th>#</th>
          <th>Description</th>
          <th>Rate</th>
          <th>Quantity</th>
          <th>Total</th>
        </thead>
        <tbody>
          <tr ng-repeat="rate in invoices.quoteRate">
            <td>{{$index + 1}}</td>
            <td>{{rate.description}}</td>
            <td>{{rate.price}}</td>
            <td>{{rate.quantity}}</td>
            <td>{{rate.total}}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  <div class="modal-footer">
    <a class="modal-action modal-close waves-effect waves-green btn-flat">Close</a>
  </div>
</div>

<!-- modal for supplier defects -->
<div ng-repeat="file in documents" class="modal modal-fixed-footer" id="modal-contractor-package-file-{{file._id}}">
  <div class="modal-content">
    <div class="col s12">
      <h5>File {{file.title}}</h5>
    </div>
    <div class="col s12">
      <p>{{file.description}}</p>
    </div>
  </div>
  <div class="modal-footer">
    <a class="modal-action modal-close waves-effect waves-green btn-flat">Close</a>
  </div>
</div>


<!-- modal for supplier defects -->
<div ng-repeat="defect in package.defects" class="modal modal-fixed-footer" id="modal-material-package-defect-{{defect._id}}">
  <div class="modal-content">
    <div class="col s12">
      <h5>Defect {{defect.title}}</h5>
    </div>
    <div class="col s12">
      <p>In {{defect.location}}, with description {{defect.description}}</p>
    </div>
  </div>
  <div class="modal-footer">
    <a class="modal-action modal-close waves-effect waves-green btn-flat">Close</a>
  </div>
</div>

<!-- modal for supplier invoice -->
<div ng-repeat="invoice in package.invoices" class="modal modal-fixed-footer" id="modal-material-package-invoice-{{invoice._id}}">
  <div class="modal-content">
    <div class="col s12">
      <h5>Invoice {{invoice.title}} with total {{invoice.total}}</h5>
    </div>
    <div class="col s12" ng-if="invoice.quotePrice">
      <h5>Quote price</h5>
      <table>
        <thead>
          <th>#</th>
          <th>Description</th>
          <th>Price</th>
          <th>Quantity</th>
          <th>Total</th>
        </thead>
        <tbody>
          <tr ng-repeat="price in invoice.quotePrice">
            <td>{{$index + 1}}</td>
            <td>{{price.description}}</td>
            <td>{{price.price}}</td>
            <td>1</td>
            <td>{{price.total}}</td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="col s12" ng-if="invoice.quoteRate">
      <h5>Quote rate</h5>
      <table>
        <thead>
          <th>#</th>
          <th>Description</th>
          <th>Rate</th>
          <th>Quantity</th>
          <th>Total</th>
        </thead>
        <tbody>
          <tr ng-repeat="rate in invoices.quoteRate">
            <td>{{$index + 1}}</td>
            <td>{{rate.description}}</td>
            <td>{{rate.price}}</td>
            <td>{{rate.quantity}}</td>
            <td>{{rate.total}}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  <div class="modal-footer">
    <a class="modal-action modal-close waves-effect waves-green btn-flat">Close</a>
  </div>
</div>

<!-- modal for supplier defects -->
<div ng-repeat="file in documents" class="modal modal-fixed-footer" id="modal-material-package-file-{{file._id}}">
  <div class="modal-content">
    <div class="col s12">
      <h5>File {{file.title}}</h5>
    </div>
    <div class="col s12">
      <p>{{file.description}}</p>
    </div>
  </div>
  <div class="modal-footer">
    <a class="modal-action modal-close waves-effect waves-green btn-flat">Close</a>
  </div>
</div>
