<div class="row" style="padding: 12px">
  <div class="col s8">
    <div class="collection with-header">
      <!-- <div class="row collection-header" style="margin-bottom:0px">
        <div class="col">
         <a class='dropdown-button btn-flat' href='#' data-activates='inTender' style="font-size: 12px;" dropdown>{{(defaultText) ? defaultText : "SCOPE"}}<i class="mdi-navigation-arrow-drop-down"></i></a>
           <ul id='inTender' class='dropdown-content'>
           <li><a ng-click="clickShowScopes()" href="#!">SCOPE</a></li>
           <li><a ng-click="clickShowTenders()" href="#!">TENDERERS</a></li>
           </ul>
        </div>
      </div> -->
      <div class="col s3" style="margin: 0px; padding:0px; background-color: white; height: {{contentHeight + 65}}px; border-right:1px solid #EEE">
        <div ng-mouseover="activeHover($event)" ng-mouseleave="removeHover($event)" ng-click="clickShowScopes()" class="collection-item" style="font-size:12px">SCOPE</div>
        <div ng-mouseover="activeHover($event)" ng-mouseleave="removeHover($event)" ng-click="clickShowTenders()" class="collection-item" style="font-size:12px">TENDERERS</div>
      </div>
      <div class="col s9 white-background">
        <div class="padding-4" ng-if="showScope">
          <div class="row collection-header" style="margin-bottom:0px;">
            <div class="col right" style="font-size:12px">
               <a ng-click="cancelPackage()" class="" style="padding: 5px;">CANCEL PACKAGE</a>
               <a class="modal-trigger" href="#modal_attachAddendum" style="padding: 5px;">ATTACH ADDENDUM</a>
            </div>
          </div>
          <div class="content-scroll" style="height: {{contentHeight +17}}px;">
            <div class="col s12">
              <strong>Start date</strong>: {{variationRequest.dateStart | date: longDate}}
              <table class="bordered centered">
                <thead>
                <tr>
                  <th>#</th>
                  <th>Scope of works</th>
                </tr>
                </thead>
                <tbody>
                <tr ng-repeat="addendum in variationRequest.addendums | filter:{isHidden:false}">
                  <td>{{$index + 1}}</td>
                  <td>{{addendum.addendumsScope.description}}</td>
                </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        
        <div class="tenderLists padding-4" ng-if="showTenders">
          <div class="row collection-header" style="margin-bottom:0px; padding:19px 0px">
            <div class="col right" style="font-size:12px">
            </div>
          </div>
          <div class="content-scroll" style="height: {{contentHeight +17}}px;">
            <div ng-mouseover="activeHover($event)" ng-mouseleave="removeHover($event)" class="collection-item row">
               <div class="col s9">
                 <div><a ng-click="viewTenderDetail(variationRequest)" href="#">{{variationRequest.to._id.name}}</a></div>
               </div>
               <div style="color: #757575">
                 <div class="col s1 valign-wrapper">
                   <div style="font-size:15px;">{{variationRequest.messages.length}}</div>
                   <i style="font-size: 15px; margin-left: 5px" class="material-icons valign">message</i>
                 </div>
                 <div class="col s1 valign-wrapper">
                   <div style="font-size:15px;">{{variationRequest.to.quoteDocument.length}} </div>
                   <i style="font-size: 15px; margin-left: 5px" class="material-icons valign">insert_drive_file</i>
                 </div>
               </div>
            </div>
          </div>
        </div>
        
        <div class="showTenderDetail padding-4" style="display:none">
          <div class="row collection-header" style="margin-bottom:0px;">
            <div class="col s12" style="font-size:12px">
              <a class="backToTendersList" href="#!" ng-click="backToList()" style="margin-left:30px; padding: 5px;">&lt; BACK TO TENDERS</a>
              <div class="right">
                <a ng-click="cancelPackage()" style="padding: 5px;">DECLINE TENDER</a>
                <a ng-click="selectQuote()" style="padding: 5px;">ACCEPT TENDER</a>
              </div>
            </div>
          </div>
          <div class="content-scroll" style="height: {{contentHeight +17}}px;">
            <div class="collection-item row" ng-repeat="quote in variationRequest.to.quoteDocument">
               <div class="col s9" ng-if="$last">
                 <div>
                    <a href="{{quote.fileUrl}}" download="{{quote.title}}">
                    <span>
                      {{quote.title}} - <i class="material-icons">cloud_download</i>
                    </span>
                    </a>
                </div>
               </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="col s4">
    <div class="collection with-header">
         
      <div style="height: {{contentHeight + 65}}px; overflow-y: auto; background-color:#fafafa; overflow-x:hidden;" class="">
        <div class="" style="height: {{contentHeight - 85}}px; overflow-y: auto">
          <div ng-class="{fromOther: !message.owner, fromMe: message.owner}" ng-if="viewMessages" ng-repeat="message in variationRequest.messages" class="row" style="font-size: 13px; margin: 12px; border-radius: 3px;">
            <div class="col s12">
              <p>{{message.message}} - <strong>From {{(currentTeam._id == message.sendBy._id) ? "Me" : message.sendBy.name}}</strong></p>
            </div>
          </div>
        </div>
        <div ng-if="viewMessages" class="row collection-footer" style="margin-bottom: 0px; background-color: white; padding: 12px; padding-top: 0px; border-top: 1px solid #E0E0E0">
           <form ng-submit="sendMessage()">
               <div class="input-field col s12" style="margin-top: 0px; margin-bottom: 0px;">
                 <textarea id="textarea1" class="materialize-textarea" ng-model="message.message" ng-keydown="enterMessage($event);"></textarea>
                 <!-- <label for="textarea1">Send a Message...</label> -->
           </div>
           <!-- <div class="input-field col s3">
               <button class="btn-large waves-effect waves-light" type="submit" style="margin-top: 47px" name="action">Send
                 <i class="mdi-content-send right"></i>
               </button>
               </div> -->
           </form>
       </div>
      </div>
    </div>
  </div>
</div>

<addendum package="variationRequest" type="variation"></addendum>



<!-- <div class="row" style="margin-top: 18px">
  <h5 class="col s8">Variation {{variationRequest.name}} in Tender</h5>
  <div class="col s4" style="margin-top:15px">
   <a class='dropdown-button btn-flat right tooltipped' dropdown data-position="top" data-delay="1" data-tooltip="Attach..." data-gutter="-16" href='#'
      data-activates='itemActions' dropdown data-beloworigin="true" data-constrainwidth="false" >
    <i class="mdi-navigation-more-vert"></i>
  </a>

  <ul id='itemActions' class='dropdown-content left'>
   <li><a class="modal-trigger" href="#modal_attachAddendum">Attach Addendum</a></li>
   <li><div class="divider"></div></li>
   <li><a ng-click="cancelPackage()">Cancel Package</a></li>
 </ul>
</div>

<div class="row">
  <div class="col s12">
    <ul class="collapsible" data-collapsible="accordion">
      <li>
        <div class="collapsible-header">
          Detail
        </div>
        <div class="collapsible-body" style="background-color: #FFF; padding:10px">
          <table>
            <thead>
              <th>Description</th>
            </thead>
            <tbody>
              <tr ng-repeat="addendum in variationRequest.addendums | filter:{isHidden:false}">
                <td>{{addendum.addendumsScope.description}}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </li>
    </ul>
  </div>
</div>

<div class="row">
  <div class="col s12">
    <ul class="collapsible" data-collapsible="accordion">
      <li>
        <div class="collapsible-header">
          Tenderer - {{variationRequest.to._id.name}}
          <a ng-if="variationRequest.to.quote" class="btn-flat btn-flat secondary-content modal-trigger" href='#modal_viewQuote_{{variationRequest.to.quote._id}}' style="font-size:12px; margin-top: 8px">View Quote</a>
        </div>
        <div class="collapsible-body" style="background-color: #FFF; padding:10px">
          <div class="row">
            <div class="col s5">
              Detail for tenderer:
              <div style="text-align:center">
                <div ng-repeat="file in files" ng-if="variationRequest.to._id._id == file.uploadBy">
                  {{file.title}} - <a href='{{file.fileUrl}}' download="file.name">Download file</a>
                </div>
                <span ng-show="variationRequest.to.quote.total > 0">
                  Total: {{variationRequest.to.quote.total}}
                </span>
              </div>
              <div ng-if="variationRequest.to.quote">
                <a style="margin: 0px -15px;" class="btn-flat btn-flat modal-trigger" href="#modal_viewQuote_{{variationRequest.to.quote._id}}">View quote</a>
                <button style="margin: 0px -15px;" ng-click="selectQuote(variationRequest._id)" class="btn-flat btn-flat valign">Select quote</button>
                <button style="margin: 0px -15px;" class="btn-flat btn-flat valign" ng-click="cancelPackage()">Decline quote</button>
              </div>
            </div>
            <div class="col s6">
             <ul class="collection">
               <div style="height: 300px; background-color: white;overflow-y: auto">
                 <li class="collection-item" ng-repeat = "message in messages.messages">
                   <div class="row valign-wrapper" style="margin-bottom: -5px;" >
                     <a href="#!" class="btn-flat col s1">
                       <i class="mdi-toggle-radio-button-on valign center-align" ></i>
                     </a>
                     <p class="col s7 valign">{{message.message}}</p>
                     <p class="circle col s4 right valign center-align"><strong>Sent by</strong>: {{message.sendBy.name}}</p>
                   </div>
                 </li>
               </div>
               <div class="divider"></div>
               <div class="col s12 card-footer" style="background-color: white">
                 <div class="row">
                   <form class="valign-wrapper" ng-submit="sendMessage(variationRequest.to._id._id)">
                     <div class="input-field col s9">
                       <textarea id="textarea1" class="materialize-textarea" ng-model="message.message"></textarea>
                       <label for="textarea1">Textarea</label>
                     </div>
                     <div class="col s3">
                       <button class="btn-flat btn-flat valign" type="submit" name="action">
                         Send
                       </button>
                     </div>
                   </form>
                 </div>
               </div>
             </ul>
           </div>
          </div>
        </div>
      </li>
    </ul>
  </div>

  <div id='modal_viewQuote_{{variationRequest.to.quote._id}}' class="modal modal-fixed-footer">
    <div class="modal-content">
      <h4>View Quote</h4>
      <p ng-show="variationRequest.to.quote.total > 0">Total: <strong>{{variationRequest.to.quote.total}}</strong></p>
      <p>{{variationRequest.to.quote.description}}</p>
      
      <div>
        <table>
          <thead>
            <th>#</th>
            <th>Description</th>
            <th>Rate</th>
            <th>Quantity</th>
            <th>Total</th>
          </thead>
          <tbody>
            <tr ng-repeat="quoteRate in variationRequest.to.quote.quoteRate">
              <td>{{$index +1}}</td>
              <td>{{quoteRate.description}}</td>
              <td>{{quoteRate.rate}}</td>
              <td>{{quoteRate.quantity}}</td>
              <td>{{quoteRate.total}}</td>
            </tr>
            <tr ng-repeat="quotePrice in variationRequest.to.quote.quotePrice">
              <td>{{$index +1}}</td>
              <td>{{quotePrice.description}}</td>
              <td>{{quotePrice.price}}</td>
              <td>{{quotePrice.quantity}}</td>
              <td>{{quotePrice.total}}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <div class="modal-footer">
      <a ng-click="selectQuote(variationRequest._id)" class="modal-action modal-close waves-effect waves-green btn-flat ">Select this quote</a>
      <a class="modal-action modal-close waves-effect waves-green btn-flat " ng-click="cancelPackage()">Decline</a>
      <a class="modal-action modal-close waves-effect waves-green btn-flat ">Close</a>
    </div>
  </div>

<div id="modal_cancelPackage" class="modal">
  <div class="modal-content">
   <div class="row">
     <div class="col s12">
       <h5>Confirm the Cancelation of variation {{variationRequest.title}}</h5>
     </div>
   </div>
   <div class="divider"></div>
   <div class="modal-footer">
     <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat ">Cancel This Variation</a>
     <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat ">Go Back</a>
   </div>
 </div>  
</div>
<addendum package="variationRequest" type="variation"></addendum> -->

